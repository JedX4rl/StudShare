# StudShare API

**StudShare** — это RESTful API для студенческой платформы по обмену вещами и размещению объявлений. Проект реализован на **Go** с использованием **чистой архитектуры**.

## Технологии

- **Язык:** Go 1.21+
- **Фреймворк:** [Chi](https://github.com/go-chi/chi) (роутинг)
- **Базы данных:**
    - PostgreSQL — основные данные
    - MongoDB — черновики объявлений
    - Redis — кеширование
- **Хранилище файлов:** MinIO (S3-совместимое)
- **Документация:** Swagger (автогенерация)
- **Аутентификация:** JWT

---

## Запуск проекта

### Требования

- Docker 20.10+
- Docker Compose 2.0+
- Go 1.21+

Сервис запускается через Docker:

```bash
docker-compose up --build
```

После запуска приложение будет доступно по адресу:  
```
http://localhost:8088
```


### Docker конфигурация

#### Dockerfile

```dockerfile
FROM golang:1.21

WORKDIR /app

COPY go.mod ./
COPY go.sum ./
RUN go mod download

COPY . ./

CMD ["go", "run", "./cmd/stud_share/main.go"]
```

#### docker-compose.yml

| Сервис     | Образ                  | Порт      |
|------------|------------------------|-----------|
| PostgreSQL | `postgres:15-3.3`      | 5436      |
| Redis      | `redis:7-alpine`       | 6379      |
| MongoDB    | `mongo:6.0`            | 27017     |
| MinIO      | `minio/minio`          | 9000-9001 |
| Миграции   | `migrate/migrate`      | —         |
| Приложение | Собирается из Dockerfile | 8088    |

---

## Структура проекта

```
./
├── cmd/              # Точка входа
├── config/           # Конфигурационные файлы
├── internal/
│   ├── adapters/     # Адаптеры БД (Postgres, Mongo, Redis, S3)
│   ├── domain/       # Модели данных
│   ├── repository/   # Репозитории
│   ├── service/      # Бизнес-логика
│   └── router/       # HTTP-обработчики
├── migrations/       # SQL-миграции
├── pkg/              # Вспомогательные пакеты
└── docs/             # Swagger-документация
```

---

## Аутентификация

| Метод | Эндпоинт       | Описание                       |
|-------|----------------|--------------------------------|
| POST  | `/auth/register` | Регистрация нового пользователя |
| POST  | `/auth/login`    | Вход в систему                 |
| POST  | `/auth/logout`   | Выход (требует JWT)            |

---

## Пользователи

| Метод | Эндпоинт          | Описание                      |
|-------|-------------------|-------------------------------|
| GET   | `/users`          | Получить свой профиль (JWT)   |
| PUT   | `/users/update`   | Обновить профиль (JWT)        |
| GET   | `/users/profile`  | Получить профиль по ID        |

---

## Объявления (Listings)

| Метод | Эндпоинт          | Описание                             |
|-------|-------------------|--------------------------------------|
| POST  | `/listings`       | Создать объявление (JWT)             |
| PUT   | `/listings`       | Обновить объявление (JWT)            |
| DELETE| `/listings`       | Удалить объявление (JWT)             |
| GET   | `/listings/all`   | Получить все объявления              |
| GET   | `/listings`       | Получить объявление по ID            |
| GET   | `/listings/near`  | Поиск объявлений по локации          |

---

## Отзывы (Reviews)

| Метод | Эндпоинт         | Описание                           |
|-------|------------------|------------------------------------|
| POST  | `/reviews`       | Добавить отзыв (JWT)               |
| DELETE| `/reviews`       | Удалить отзыв (JWT)                |
| GET   | `/reviews/user`  | Получить отзывы о пользователе     |

---

## Черновики (Drafts)

| Метод | Эндпоинт         | Описание                            |
|-------|------------------|-------------------------------------|
| POST  | `/drafts`        | Создать черновик (JWT)              |
| GET   | `/drafts/all`    | Получить все черновики (JWT)        |
| GET   | `/drafts`        | Получить черновик по ID (JWT)       |
| DELETE| `/drafts`        | Удалить черновик (JWT)              |

---

## Файлы (S3)

| Метод | Эндпоинт         | Описание                            |
|-------|------------------|-------------------------------------|
| POST  | `/files`         | Загрузить файл (JWT)                |
| DELETE| `/files/{key}`   | Удалить файл по ключу (JWT)         |

---
## Переменные окружения

Основные настройки хранятся в:

- `config/server_config.yaml` — настройки сервера
- `config/storage_config.yaml` — настройки хранилищ (БД, S3 и т.п.)
- `config/auth_config.yaml` — настройки аутентификации

Переменные окружения:

```env
CONFIG_SERVER_PATH=config/server_config.yaml
CONFIG_STORAGE_PATH=config/storage_config.yaml
CONFIG_AUTH_PATH=config/auth_config.yaml
```